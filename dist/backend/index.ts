"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("firebase/app"),r=require("firebase/auth");function t(e,r,t,n){return new(t||(t=Promise))((function(o,s){function a(e){try{u(n.next(e))}catch(e){s(e)}}function i(e){try{u(n.throw(e))}catch(e){s(e)}}function u(e){var r;e.done?o(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(a,i)}u((n=n.apply(e,r||[])).next())}))}function n(e,r){var t,n,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(i){return function(u){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;s&&(s=0,i[0]&&(a=0)),a;)try{if(t=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=r.call(e,a)}catch(e){i=[6,e],n=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}const o=()=>{let e={},r=!1;return process.env.SEO_MANAGER_MODULE_SECRETKEY&&(e.secretKey=process.env.SEO_MANAGER_MODULE_SECRETKEY,r=!0),process.env.SEO_MANAGER_MODULE_PROJECTKEY&&(e.projectKey=process.env.SEO_MANAGER_MODULE_PROJECTKEY,r=!0),process.env.SEO_MANAGER_MODULE_PROJECTID&&(e.projectId=process.env.SEO_MANAGER_MODULE_PROJECTID,r=!0),!!r&&e},s="Test"!==process.env.NEXT_PUBLIC_NODE_ENV_MANAGER&&"Development"!==process.env.NEXT_PUBLIC_NODE_ENV_MANAGER?{apiKey:"AIzaSyDPjpRmobrdUtIY3hIaNoyox7alxYJH_B8",authDomain:"seo-manager-live.firebaseapp.com",projectId:"seo-manager-live",storageBucket:"seo-manager-live.appspot.com",messagingSenderId:"510256510596",appId:"1:510256510596:web:eae1ccc42cb103b8a7f4d1",measurementId:"G-RED1HCM49W"}:{apiKey:"AIzaSyBD6KEJFm2SVguRDEiqufIlRo5HuHu0IZg",authDomain:"seo-manager-test.firebaseapp.com",projectId:"seo-manager-test",storageBucket:"seo-manager-test.appspot.com",messagingSenderId:"682714204028",appId:"1:682714204028:web:a782b9da96ce811ee606f9",measurementId:"G-PYZDK47B2M"};let a;const i=e.getApps()?.findIndex((e=>{if("seo-manager"===e?.name)return!0}));a=i<0?e.initializeApp(s,"seo-manager"):e.getApp("seo-manager");var u=a;const c=require("axios"),l="v1",p=(e,r="put",t,n,s)=>new Promise((async(a,i)=>{try{const u=o();if(!u?.projectId)return i({results:!1,error:"Project Id is required"});if(!u?.secretKey)return i({results:!1,error:"Project Secret Key is required"});const p=d(e),v=n||("Test"!==process.env.NEXT_PUBLIC_NODE_ENV_MANAGER&&"Development"!==process.env.NEXT_PUBLIC_NODE_ENV_MANAGER?`https://seo-manager-website.vercel.app/api/${l}/${p}`:"Test"===process.env.NEXT_PUBLIC_NODE_ENV_MANAGER?`http://localhost:3001/api/${l}/${p}`:`https://seo-manager-website-git-testing-shadow-republic.vercel.app/api/${l}/${p}`);let E={X_ProjectId:u?.projectId,X_ProjectKey:u?.projectKey,X_ProjectSecretKey:u?.secretKey};s&&(E={...E,...s});const f=await c({method:r||"post",url:v,data:t||{},headers:E});return a({results:f?.data?.results||!1,error:f?.data?.error||!0,message:f?.data?.message||"There was an error on our end! Please try again in a few mintues!"})}catch(e){return a({results:e?.response?.data?.results||!1,error:e?.response?.data?.error||!0,message:e?.response?.data?.message||"There was an error on our end! Please try again in a few mintues!"})}})),d=e=>{let r=e;return"/"===r[0]&&(r=r.replace("/","")),r};r.getAuth(u);const v=(e,r={})=>new Promise((async(t,n)=>{try{if(process.browser)throw{error:"This function is only allowed to be called in a server environment, not in the client. If you are using NextJS this belong in getServerSideProps or getStaticProps."};if(!e)throw{error:"You must pass page path!"};console.log("REQUEST:",r?.headers);const{results:n,error:s}=await((e,r="put",t,n,s)=>new Promise((async(a,i)=>{try{const u=o();if(!u?.projectId)return i({results:!1,error:"Project Id is required"});const p=d(e),v=n||("Test"!==process.env.NEXT_PUBLIC_NODE_ENV_MANAGER&&"Development"!==process.env.NEXT_PUBLIC_NODE_ENV_MANAGER?`https://seo-manager-website.vercel.app/api/${l}/${p}`:"Test"===process.env.NEXT_PUBLIC_NODE_ENV_MANAGER?`http://localhost:3001/api/${l}/${p}`:`https://seo-manager-website-git-testing-shadow-republic.vercel.app/api/${l}/${p}`);let E={X_ProjectId:u?.projectId,X_ProjectKey:u?.projectKey};s&&(E={...E,...s});const f=await c({method:r||"post",url:v,data:t||{},headers:E});return a(f?.data?.results?{results:f?.data?.results}:{results:f?.data?.results||!1,error:f?.data?.error||!0,message:f?.data?.message||"There was an error on our end! Please try again in a few mintues!"})}catch(e){return a({results:!1,data:e?.response?.data})}})))("/seo/server_get","put",{path:e,headers:r?.headers||{}});return t(n?{results:n}:{results:!1,error:s,message:"No SEO data for this page found"})}catch(e){return t({results:!1,error:e.error})}}));var E=function(){var e=o();if(!(null==e?void 0:e.secretKey))throw{error:"Please add a secretKey by calling the SEOInit function SEOInit({secretKey: '<<Add Value Here>>'}). Make sure you initialize this in your Api, not _app.js!"};if(!(null==e?void 0:e.projectId))throw{error:"Please add a projectId by calling the SEOInit function SEOInit({projectId: '<<Add Value Here>>'}). Make sure you initialize this in your Api, not _app.js!"}};exports.SEOInit=function(e){(({projectId:e,projectKey:r,secretKey:t})=>{let n={...o()||{}};if(e&&(n.projectId=e,process.env.SEO_MANAGER_MODULE_PROJECTID=e),r&&(n.projectKey=r,process.env.SEO_MANAGER_MODULE_PROJECTKEY=r),t&&(n.secretKey=t,process.env.SEO_MANAGER_MODULE_SECRETKEY=t),!n?.projectId)throw"Please add a projectId by calling the SEOInit function SEOInit({projectId: '<<Add Value Here>>'})"})({projectId:e.projectId,projectKey:e.projectKey,secretKey:e.secretKey})},exports.backendValidation=function(e){return new Promise((function(r,o){return t(void 0,void 0,void 0,(function(){var t,o,s;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),E(),[4,p("/backend/validate","put",{queueId:e})];case 1:return t=n.sent(),[2,r(t)];case 2:return o=n.sent(),[2,r({results:!1,error:(null===(s=null==o?void 0:o.data)||void 0===s?void 0:s.error)||(null==o?void 0:o.error)||"Something went wrong"})];case 3:return[2]}}))}))}))},exports.checkBackendKeys=E,exports.deleteSeoPage=function(e){return new Promise((function(r,o){return t(void 0,void 0,void 0,(function(){var t,o,s;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),E(),[4,p("backend/seo/delete","post",{pageIdentifiers:e})];case 1:return t=n.sent(),[2,r(t)];case 2:return o=n.sent(),[2,r({results:!1,error:(null===(s=null==o?void 0:o.data)||void 0===s?void 0:s.error)||(null==o?void 0:o.error)||"Something went wrong"})];case 3:return[2]}}))}))}))},exports.fetchSEO=function(e,r){return void 0===r&&(r={}),new Promise((function(o,s){return t(void 0,void 0,void 0,(function(){var t;return n(this,(function(n){switch(n.label){case 0:return[4,v(e,r)];case 1:return t=n.sent(),[2,o(t)]}}))}))}))},exports.getSeoPage=function(e){return new Promise((function(r,o){return t(void 0,void 0,void 0,(function(){var t,o,s;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),E(),[4,p("backend/seo/get","post",{pageIdentifiers:e})];case 1:return t=n.sent(),[2,r(t)];case 2:return o=n.sent(),[2,r({results:!1,error:(null===(s=null==o?void 0:o.data)||void 0===s?void 0:s.error)||(null==o?void 0:o.error)||"Something went wrong"})];case 3:return[2]}}))}))}))},exports.getSeoPages=function(e){return new Promise((function(r,o){return t(void 0,void 0,void 0,(function(){var t,o,s;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),E(),[4,p("backend/seo/getSeoPages","post",{pageIdentifiers:e})];case 1:return t=n.sent(),[2,r(t)];case 2:return o=n.sent(),[2,r({results:!1,error:(null===(s=null==o?void 0:o.data)||void 0===s?void 0:s.error)||(null==o?void 0:o.error)||"Something went wrong"})];case 3:return[2]}}))}))}))},exports.insertSeoPage=function(e,r,o){return new Promise((function(s,a){return t(void 0,void 0,void 0,(function(){var t,a,i;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),E(),[4,p("backend/seo/insert","post",{pageIdentifiers:e,pageSEO:r,options:o})];case 1:return t=n.sent(),[2,s(t)];case 2:return a=n.sent(),console.error(a),[2,s({results:!1,error:(null===(i=null==a?void 0:a.data)||void 0===i?void 0:i.error)||(null==a?void 0:a.error)||"Something went wrong"})];case 3:return[2]}}))}))}))},exports.updateSeoPage=function(e,r,o){return new Promise((function(s,a){return t(void 0,void 0,void 0,(function(){var t,a,i;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),E(),[4,p("backend/seo/update","put",{pageIdentifiers:e,pageSEO:r,options:o})];case 1:return t=n.sent(),[2,s(t)];case 2:return a=n.sent(),[2,s({results:!1,error:(null===(i=null==a?void 0:a.data)||void 0===i?void 0:i.error)||(null==a?void 0:a.error)||"Something went wrong"})];case 3:return[2]}}))}))}))};
