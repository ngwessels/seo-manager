import{getApps as e,initializeApp as r,getApp as t}from"firebase/app";import{getAuth as n}from"firebase/auth";function o(e,r,t,n){return new(t||(t=Promise))((function(o,s){function a(e){try{u(n.next(e))}catch(e){s(e)}}function i(e){try{u(n.throw(e))}catch(e){s(e)}}function u(e){var r;e.done?o(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(a,i)}u((n=n.apply(e,r||[])).next())}))}function s(e,r){var t,n,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(i){return function(u){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;s&&(s=0,i[0]&&(a=0)),a;)try{if(t=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=r.call(e,a)}catch(e){i=[6,e],n=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}const a=()=>{let e={},r=!1;return process.env.SEO_MANAGER_MODULE_SECRETKEY&&(e.secretKey=process.env.SEO_MANAGER_MODULE_SECRETKEY,r=!0),process.env.SEO_MANAGER_MODULE_PROJECTKEY&&(e.projectKey=process.env.SEO_MANAGER_MODULE_PROJECTKEY,r=!0),process.env.SEO_MANAGER_MODULE_PROJECTID&&(e.projectId=process.env.SEO_MANAGER_MODULE_PROJECTID,r=!0),!!r&&e},i="Test"!==process.env.NEXT_PUBLIC_NODE_ENV_MANAGER&&"Development"!==process.env.NEXT_PUBLIC_NODE_ENV_MANAGER?{apiKey:"AIzaSyDPjpRmobrdUtIY3hIaNoyox7alxYJH_B8",authDomain:"seo-manager-live.firebaseapp.com",projectId:"seo-manager-live",storageBucket:"seo-manager-live.appspot.com",messagingSenderId:"510256510596",appId:"1:510256510596:web:eae1ccc42cb103b8a7f4d1",measurementId:"G-RED1HCM49W"}:{apiKey:"AIzaSyBD6KEJFm2SVguRDEiqufIlRo5HuHu0IZg",authDomain:"seo-manager-test.firebaseapp.com",projectId:"seo-manager-test",storageBucket:"seo-manager-test.appspot.com",messagingSenderId:"682714204028",appId:"1:682714204028:web:a782b9da96ce811ee606f9",measurementId:"G-PYZDK47B2M"};let u;const c=e()?.findIndex((e=>{if("seo-manager"===e?.name)return!0}));u=c<0?r(i,"seo-manager"):t("seo-manager");var l=u;const d=require("axios"),p="v1",v=(e,r="put",t,n,o)=>new Promise((async(s,i)=>{try{const u=a();if(!u?.projectId)return i({results:!1,error:"Project Id is required"});if(!u?.secretKey)return i({results:!1,error:"Project Secret Key is required"});const c=E(e),l=n||("Test"!==process.env.NEXT_PUBLIC_NODE_ENV_MANAGER&&"Development"!==process.env.NEXT_PUBLIC_NODE_ENV_MANAGER?`https://seo-manager-website.vercel.app/api/${p}/${c}`:"Test"===process.env.NEXT_PUBLIC_NODE_ENV_MANAGER?`http://localhost:3001/api/${p}/${c}`:`https://seo-manager-website-git-testing-shadow-republic.vercel.app/api/${p}/${c}`);let v={X_ProjectId:u?.projectId,X_ProjectKey:u?.projectKey,X_ProjectSecretKey:u?.secretKey};o&&(v={...v,...o});const f=await d({method:r||"post",url:l,data:t||{},headers:v});return s({results:f?.data?.results||!1,error:f?.data?.error||!0,message:f?.data?.message||"There was an error on our end! Please try again in a few mintues!"})}catch(e){return s({results:e?.response?.data?.results||!1,error:e?.response?.data?.error||!0,message:e?.response?.data?.message||"There was an error on our end! Please try again in a few mintues!"})}})),E=e=>{let r=e;return"/"===r[0]&&(r=r.replace("/","")),r};n(l);const f=(e,r={})=>new Promise((async(t,n)=>{try{if(process.browser)throw{error:"This function is only allowed to be called in a server environment, not in the client. If you are using NextJS this belong in getServerSideProps or getStaticProps."};if(!e)throw{error:"You must pass page path!"};console.log("REQUEST:",r?.headers);const{results:n,error:o}=await((e,r="put",t,n,o)=>new Promise((async(s,i)=>{try{const u=a();if(!u?.projectId)return i({results:!1,error:"Project Id is required"});const c=E(e),l=n||("Test"!==process.env.NEXT_PUBLIC_NODE_ENV_MANAGER&&"Development"!==process.env.NEXT_PUBLIC_NODE_ENV_MANAGER?`https://seo-manager-website.vercel.app/api/${p}/${c}`:"Test"===process.env.NEXT_PUBLIC_NODE_ENV_MANAGER?`http://localhost:3001/api/${p}/${c}`:`https://seo-manager-website-git-testing-shadow-republic.vercel.app/api/${p}/${c}`);let v={X_ProjectId:u?.projectId,X_ProjectKey:u?.projectKey};o&&(v={...v,...o});const f=await d({method:r||"post",url:l,data:t||{},headers:v});return s(f?.data?.results?{results:f?.data?.results}:{results:f?.data?.results||!1,error:f?.data?.error||!0,message:f?.data?.message||"There was an error on our end! Please try again in a few mintues!"})}catch(e){return s({results:!1,data:e?.response?.data})}})))("/seo/server_get","put",{path:e,headers:r?.headers||{}});return t(n?{results:n}:{results:!1,error:o,message:"No SEO data for this page found"})}catch(e){return t({results:!1,error:e.error})}}));var h=function(e){(({projectId:e,projectKey:r,secretKey:t})=>{let n={...a()||{}};if(e&&(n.projectId=e,process.env.SEO_MANAGER_MODULE_PROJECTID=e),r&&(n.projectKey=r,process.env.SEO_MANAGER_MODULE_PROJECTKEY=r),t&&(n.secretKey=t,process.env.SEO_MANAGER_MODULE_SECRETKEY=t),!n?.projectId)throw"Please add a projectId by calling the SEOInit function SEOInit({projectId: '<<Add Value Here>>'})"})({projectId:e.projectId,projectKey:e.projectKey,secretKey:e.secretKey})},g=function(e,r){return void 0===r&&(r={}),new Promise((function(t,n){return o(void 0,void 0,void 0,(function(){var n;return s(this,(function(o){switch(o.label){case 0:return[4,f(e,r)];case 1:return n=o.sent(),[2,t(n)]}}))}))}))},m=function(e){return new Promise((function(r,t){return o(void 0,void 0,void 0,(function(){var t,n,o;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),_(),[4,v("/backend/validate","put",{queueId:e})];case 1:return t=s.sent(),[2,r(t)];case 2:return n=s.sent(),[2,r({results:!1,error:(null===(o=null==n?void 0:n.data)||void 0===o?void 0:o.error)||(null==n?void 0:n.error)||"Something went wrong"})];case 3:return[2]}}))}))}))},_=function(){var e=a();if(!(null==e?void 0:e.secretKey))throw{error:"Please add a secretKey by calling the SEOInit function SEOInit({secretKey: '<<Add Value Here>>'}). Make sure you initialize this in your Api, not _app.js!"};if(!(null==e?void 0:e.projectId))throw{error:"Please add a projectId by calling the SEOInit function SEOInit({projectId: '<<Add Value Here>>'}). Make sure you initialize this in your Api, not _app.js!"}},y=function(e,r,t){return new Promise((function(n,a){return o(void 0,void 0,void 0,(function(){var o,a,i;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),_(),[4,v("backend/seo/insert","post",{pageIdentifiers:e,pageSEO:r,options:t})];case 1:return o=s.sent(),[2,n(o)];case 2:return a=s.sent(),console.error(a),[2,n({results:!1,error:(null===(i=null==a?void 0:a.data)||void 0===i?void 0:i.error)||(null==a?void 0:a.error)||"Something went wrong"})];case 3:return[2]}}))}))}))},w=function(e,r,t){return new Promise((function(n,a){return o(void 0,void 0,void 0,(function(){var o,a,i;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),_(),[4,v("backend/seo/update","put",{pageIdentifiers:e,pageSEO:r,options:t})];case 1:return o=s.sent(),[2,n(o)];case 2:return a=s.sent(),[2,n({results:!1,error:(null===(i=null==a?void 0:a.data)||void 0===i?void 0:i.error)||(null==a?void 0:a.error)||"Something went wrong"})];case 3:return[2]}}))}))}))},I=function(e){return new Promise((function(r,t){return o(void 0,void 0,void 0,(function(){var t,n,o;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),_(),[4,v("backend/seo/delete","post",{pageIdentifiers:e})];case 1:return t=s.sent(),[2,r(t)];case 2:return n=s.sent(),[2,r({results:!1,error:(null===(o=null==n?void 0:n.data)||void 0===o?void 0:o.error)||(null==n?void 0:n.error)||"Something went wrong"})];case 3:return[2]}}))}))}))},b=function(e){return new Promise((function(r,t){return o(void 0,void 0,void 0,(function(){var t,n,o;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),_(),[4,v("backend/seo/get","post",{pageIdentifiers:e})];case 1:return t=s.sent(),[2,r(t)];case 2:return n=s.sent(),[2,r({results:!1,error:(null===(o=null==n?void 0:n.data)||void 0===o?void 0:o.error)||(null==n?void 0:n.error)||"Something went wrong"})];case 3:return[2]}}))}))}))},N=function(e){return new Promise((function(r,t){return o(void 0,void 0,void 0,(function(){var t,n,o;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),_(),[4,v("backend/seo/getSeoPages","post",{pageIdentifiers:e})];case 1:return t=s.sent(),[2,r(t)];case 2:return n=s.sent(),[2,r({results:!1,error:(null===(o=null==n?void 0:n.data)||void 0===o?void 0:o.error)||(null==n?void 0:n.error)||"Something went wrong"})];case 3:return[2]}}))}))}))};export{h as SEOInit,m as backendValidation,_ as checkBackendKeys,I as deleteSeoPage,g as fetchSEO,b as getSeoPage,N as getSeoPages,y as insertSeoPage,w as updateSeoPage};
