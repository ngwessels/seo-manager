"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react");function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var t=r(e);const s=({projectId:e,projectKey:r,secretKey:t})=>{let s={...o()||{}};if(e&&(s.projectId=e,process.env.SEO_MANAGER_MODULE_PROJECTID=e),r&&(s.projectKey=r,process.env.SEO_MANAGER_MODULE_PROJECTKEY=r),t&&(s.secretKey=t,process.env.SEO_MANAGER_MODULE_SECRETKEY=t),!s?.projectId)throw"Please add a projectId by calling the SEOInit function SEOInit({projectId: '<<Add Value Here>>'})"},o=()=>{let e={},r=!1;return process.env.SEO_MANAGER_MODULE_SECRETKEY&&(e.secretKey=process.env.SEO_MANAGER_MODULE_SECRETKEY,r=!0),process.env.SEO_MANAGER_MODULE_PROJECTKEY&&(e.projectKey=process.env.SEO_MANAGER_MODULE_PROJECTKEY,r=!0),process.env.SEO_MANAGER_MODULE_PROJECTID&&(e.projectId=process.env.SEO_MANAGER_MODULE_PROJECTID,r=!0),!!r&&e},n=require("axios"),a=(e,r="put",t,s,a)=>new Promise((async(p,i)=>{try{const E=o();if(!E?.projectId)return i({results:!1,error:"Project Id is required"});const l=c(e),u=s||("Test"!==process.env.NEXT_PUBLIC_NODE_ENV_MANAGER&&"Development"!==process.env.NEXT_PUBLIC_NODE_ENV_MANAGER?`https://seo-manager-website.vercel.app/api/v1/${l}`:"Test"===process.env.NEXT_PUBLIC_NODE_ENV_MANAGER?`http://localhost:3001/api/v1/${l}`:`https://seo-manager-website-git-testing-shadow-republic.vercel.app/api/v1/${l}`);let d={X_ProjectId:E?.projectId,X_ProjectKey:E?.projectKey};a&&(d={...d,...a});const _=await n({method:r||"post",url:u,data:t||{},headers:d});return _?.data?.results?p({results:_?.data?.results}):i({results:!1,error:!1,message:"Not Successful"})}catch(e){return i({results:!1,data:e?.response?.data})}})),c=e=>{let r=e;return"/"===r[0]&&(r=r.replace("/","")),r};class p extends t.default.Component{static async getInitialProps({res:e,req:r}){e.setHeader("Content-Type","text/xml");try{const{results:t}=await a("/sitemap/","put",{path:r.url});e.write(t)}catch(e){console.error(e.error)}e.end()}}class i extends e.Component{static async getInitialProps({res:e}){e.setHeader("Content-Type","text/plain");try{const{results:r}=await a("/robots/","put");e.write(r)}catch(e){console.error(e.error)}e.end()}}exports.RobotsHelper=i,exports.SEOInit=({projectId:e,projectKey:r,secretKey:t})=>{s({projectId:e,projectKey:r,secretKey:t})},exports.SEOinitialize=s,exports.SitemapHelper=p,exports.backendValidation=e=>new Promise((async(r,t)=>{try{const t=o();if(!t?.secretKey)throw{error:"Please add a secretKey by calling the SEOInit function SEOInit({secretKey: '<<Add Value Here>>'}). Make sure you initialize this in your Api, not _app.js!"};if(!t?.projectId)throw{error:"Please add a projectId by calling the SEOInit function SEOInit({projectId: '<<Add Value Here>>'}). Make sure you initialize this in your Api, not _app.js!"};const s=await((e,r="put",t,s,a)=>new Promise((async(p,i)=>{try{const E=o();if(!E?.projectId)return i({results:!1,error:"Project Id is required"});if(!E?.secretKey)return i({results:!1,error:"Project Secret Key is required"});const l=c(e),u=s||("Test"!==process.env.NEXT_PUBLIC_NODE_ENV_MANAGER&&"Development"!==process.env.NEXT_PUBLIC_NODE_ENV_MANAGER?`https://seo-manager-website.vercel.app/api/v1/${l}`:"Test"===process.env.NEXT_PUBLIC_NODE_ENV_MANAGER?`http://localhost:3001/api/v1/${l}`:`https://seo-manager-website-git-testing-shadow-republic.vercel.app/api/v1/${l}`);let d={X_ProjectId:E?.projectId,X_ProjectKey:E?.projectKey,X_ProjectSecretKey:E?.secretKey};a&&(d={...d,...a});const _=await n({method:r||"post",url:u,data:t||{},headers:d});return _?.data?.results?p({results:_?.data?.results}):i({results:!1,error:!1,message:"Not Successful"})}catch(e){return i({results:!1,data:e?.response?.data})}})))("/backend/validate","put",{queueId:e});return r(s)}catch(e){return r({results:!1,error:e?.data?.error||e?.error||"Something went wrong"})}})),exports.fetchSEO=e=>new Promise((async(r,t)=>{const s=await(e=>new Promise((async(r,t)=>{try{if(process.browser)throw{error:"This function is only allowed to be called in a server environment, not in the client. If you are using NextJS this belong in getServerSideProps or getStaticProps."};const{results:t,error:s}=await a("/seo/server_get","put",{path:e});return r(t?{results:t}:{results:!1,error:s,message:"No SEO data for this page found"})}catch(e){return r({results:!1,error:e.error})}})))(e);return r(s)})),exports.returnKey=o,exports.returnProject=()=>{const e=process.env.SEO_MANAGER_MODULE_PROJECT;return e?JSON.parse(e):null},exports.setProject=e=>{process.env.SEO_MANAGER_MODULE_PROJECT=JSON.stringify(e)};
