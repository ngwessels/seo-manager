import{_ as o,s as e}from"./serverCall-81f1063a.js";import i from"react";import{connect as t}from"react-redux";import{DialogTitle as r,IconButton as s,DialogContent as l,Box as n,Typography as d}from"@mui/material";import u from"@mui/icons-material/Close";import{f as a}from"./firebase-f83deced.js";import{getAuth as v}from"firebase/auth";import{B as p}from"./BootstrapDialog-12d92754.js";import"axios";import"./index-36049004.js";import"firebase/app";import"@mui/material/styles";const h=v(a);class m extends i.Component{constructor(i){var t,r;super(i),this.componentDidMount=()=>{var o,e,i,t;const r=null===(e=null===(o=this.props)||void 0===o?void 0:o.user)||void 0===e?void 0:e.isLoggedIn,s=null===(t=null===(i=this.props)||void 0===i?void 0:i.user)||void 0===t?void 0:t.authorizedProject;this.setState({userAuthorized:s,userLoaded:r,userSetup:!1})},this.componentDidUpdate=o=>{var e,i,t,r,s,l,n,d,u,a;(null===(e=null==o?void 0:o.user)||void 0===e?void 0:e.isLoggedIn)===(null===(t=null===(i=this.props)||void 0===i?void 0:i.user)||void 0===t?void 0:t.isLoggedIn)&&(null===(r=null==o?void 0:o.user)||void 0===r?void 0:r.authorizedProject)===(null===(l=null===(s=this.props)||void 0===s?void 0:s.user)||void 0===l?void 0:l.authorizedProject)||(this.setState({userAuthorized:null===(d=null===(n=this.props)||void 0===n?void 0:n.user)||void 0===d?void 0:d.authorizedProject,userLoaded:null===(a=null===(u=this.props)||void 0===u?void 0:u.user)||void 0===a?void 0:a.isLoggedIn}),this.userLoginSetup())},this.userLoginSetup=()=>{var i,t,r,s,l;const n=null===(t=null===(i=this.props)||void 0===i?void 0:i.user)||void 0===t?void 0:t.isLoggedIn,d=null===(s=null===(r=this.props)||void 0===r?void 0:r.user)||void 0===s?void 0:s.authorizedProject;!0===n&&!1===d&&!1===this.state.userSetup&&(this.setState({userSetup:!0}),null===(l=null==h?void 0:h.currentUser)||void 0===l||l.getIdToken().then(i=>o(this,void 0,void 0,function*(){var o,t,r,s,l;console.log(this.props);const n=yield e("/seo/setup_authorization","post",{pageId:null===(s=null===(r=null===(t=null===(o=this.props)||void 0===o?void 0:o.seoData)||void 0===t?void 0:t.initial)||void 0===r?void 0:r.page)||void 0===s?void 0:s.pageId},void 0,{X_Authorization:i,AuthorizationId:null===(l=null==h?void 0:h.currentUser)||void 0===l?void 0:l.uid});console.log("Authorization Setup Response: ",n)})))},this.state={loading:!1,loginError:"",userAuthorized:null===(t=null==i?void 0:i.user)||void 0===t?void 0:t.authorizedProject,userLoaded:null===(r=null==i?void 0:i.user)||void 0===r?void 0:r.isLoggedIn,userSetup:!1}}render(){return this.state.userAuthorized||!this.state.userLoaded?null:i.createElement(i.Fragment,null,i.createElement(p,{onClose:this.props.onClose,"aria-labelledby":"SEO Manager Login",open:!0,maxWidth:!1,style:{zIndex:100}},i.createElement(r,{sx:{m:0,p:2},className:"nextjs-seo-manager__title"},"Login",i.createElement(s,{"aria-label":"close",onClick:this.props.onClose,sx:{position:"absolute",right:8,top:8,color:o=>o.palette.grey[500]}},i.createElement(u,null))),i.createElement(l,null,i.createElement(n,{mb:1},i.createElement(d,{className:"nextjs-seo-manager__p"},"Please login to your SEO Manager Account to continue. To Login either scan the QR Code or Click the redirect link below.")))))}}var c=t(o=>({user:null==o?void 0:o.user,seoData:null==o?void 0:o.seoData}))(m);export{c as default};
