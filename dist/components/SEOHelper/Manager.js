import{__awaiter as e}from"../../node_modules/tslib/tslib.es6.js";import t from"react";import{firebase as a}from"../../firebase.js";import{getAuth as n}from"firebase/auth";import{serverCall as o}from"../../utils/call.js";import l from"../../node_modules/react-tag-autocomplete/dist/ReactTags.esm.js";import i from"./PagePhoto.js";import{hideModal as s,authSignOut as r}from"./utils.js";const c=n(a);class m extends t.Component{constructor(a){super(a),this.componentDidMount=()=>e(this,void 0,void 0,(function*(){var t;this.setState({loading:!0}),null===(t=null==c?void 0:c.currentUser)||void 0===t||t.getIdToken().then((t=>e(this,void 0,void 0,(function*(){var e;const a=yield o("/seo/get","put",{path:this.props.data.path},void 0,{X_Authorization:t,AuthorizationId:null===(e=null==c?void 0:c.currentUser)||void 0===e?void 0:e.uid});a&&this.props.onChange(null==a?void 0:a.results,!0),this.setState({loading:!1})}))))})),this.onChange=(e,t)=>{let a=Object.assign({},this.props.data);a[t]||""===a[t]?(a[t]=e,this.props.onChange(a,!1),this.setState({data:a})):this.setState({[t]:e})},this.onDelete=e=>{let t=this.props.data.keywordsArray;t.splice(e,1);let a="";Object.keys(t).forEach((e=>{const n=t[e];a+=`${n.name}, `})),this.onChange(t,"keywordsArray"),this.onChange(a,"keywords")},this.onAddition=e=>{let t=this.props.data.keywordsArray;t.push({name:e.name,id:t.length});let a="";Object.keys(t).forEach((e=>{const n=t[e];a+=`${n.name}, `})),this.onChange(t,"keywordsArray"),this.onChange(a,"keywords")},this.addPerformAction=(e,t)=>{let a=this.state.performActionOnUpdate;a[t]=e,this.setState({performActionOnUpdate:a})},this.saveData=()=>{var t;this.setState({saving:!0}),null===(t=null==c?void 0:c.currentUser)||void 0===t||t.getIdToken().then((t=>e(this,void 0,void 0,(function*(){var a;const n=Object.keys(this.state.performActionOnUpdate).map((t=>e(this,void 0,void 0,(function*(){const e=this.state.performActionOnUpdate[t];return e&&e.action&&(yield e.action()),!0}))));yield Promise.all(n),yield o("/seo/update","put",{data:this.props.data},void 0,{X_Authorization:t,AuthorizationId:null===(a=null==c?void 0:c.currentUser)||void 0===a?void 0:a.uid}),this.setState({saving:!1}),this.props.onChangeComplete(this.props.data.path),s()}))))},this.state={loading:!0,saving:!1,newImage:"",file:null,performActionOnUpdate:{}},this.reactTags=t.createRef()}render(){return t.createElement(t.Fragment,null,this.state.loading?t.createElement("div",{style:{width:"100%",height:400,display:"flex",justifyContent:"center",alignItems:"center"}},t.createElement("div",{className:"spinner-border",role:"status"},t.createElement("span",{className:"visually-hidden"},"Loading..."))):t.createElement(t.Fragment,null,t.createElement("div",{className:"form-floating mb-3"},t.createElement(i,{onChange:this.onChange,image:this.props.data.image,newImage:this.state.newImage,addPerformActionOnUpdate:this.addPerformAction,data:this.props.data,file:this.state.file,user:this.props.user})),t.createElement("div",{className:"form-floating mb-3"},t.createElement("input",{className:"form-control",id:"title",placeholder:"Home - Stark Industries",onChange:e=>{this.onChange(e.target.value,"title")},value:this.props.data.title}),t.createElement("label",{htmlFor:"floatingInput"},"Title")),t.createElement("div",{className:"form-floating mb-3"},t.createElement("textarea",{className:"form-control",placeholder:"Page Description",id:"description",onChange:e=>{this.onChange(e.target.value,"description")},value:this.props.data.description,style:{minHeight:200}}),t.createElement("label",{htmlFor:"description"},"Page Description")),t.createElement(l,{ref:this.reactTags,tags:this.props.data.keywordsArray,onDelete:this.onDelete,onAddition:this.onAddition,placeholderText:"Add Page Keywords",allowNew:!0,allowBackspace:!0}),t.createElement("div",{className:"form-floating mb-3"},t.createElement("select",{className:"form-select",id:"follow","aria-label":"Should search engines follow the page?",value:this.props.data.follow,onChange:e=>{this.onChange(e.target.value,"follow")}},t.createElement("option",null,"Open this select menu"),t.createElement("option",{value:"follow"},"Follow"),t.createElement("option",{value:"nofollow"},"No Following")),t.createElement("label",{htmlFor:"follow"},"Should search engines follow the page?")),t.createElement("div",{className:"form-floating mb-3"},t.createElement("select",{className:"form-select",id:"index","aria-label":"Should search engines index the page?",value:this.props.data.index,onChange:e=>{this.onChange(e.target.value,"index")}},t.createElement("option",null,"Open this select menu"),t.createElement("option",{value:"index"},"Index"),t.createElement("option",{value:"noindex"},"No Index")),t.createElement("label",{htmlFor:"index"},"Should search engines index the page?")),t.createElement("div",{className:"form-floating mb-3"},t.createElement("select",{className:"form-select",id:"changeFreq","aria-label":"How often will the content change?",value:this.props.data.changeFreq,onChange:e=>{this.onChange(e.target.value,"changeFreq")}},t.createElement("option",null,"Open this select menu"),t.createElement("option",{value:"always"},"Always"),t.createElement("option",{value:"daily"},"Daily"),t.createElement("option",{value:"weekly"},"Weekly"),t.createElement("option",{value:"monthly"},"Monthly"),t.createElement("option",{value:"yearly"},"Yearly"),t.createElement("option",{value:"never"},"Never")),t.createElement("label",{htmlFor:"changeFreq"},"How often will the content change?")),t.createElement("div",{className:"form-floating mb-3"},t.createElement("select",{className:"form-select",id:"priority","aria-label":"Page Priority",value:this.props.data.priority,onChange:e=>{this.onChange(e.target.value,"priority")}},t.createElement("option",null,"Open this select menu"),t.createElement("option",{value:.1},"1"),t.createElement("option",{value:.2},"2"),t.createElement("option",{value:.3},"3"),t.createElement("option",{value:.4},"4"),t.createElement("option",{value:.5},"5"),t.createElement("option",{value:.6},"6"),t.createElement("option",{value:.7},"7"),t.createElement("option",{value:.8},"8"),t.createElement("option",{value:.9},"9"),t.createElement("option",{value:1},"10")),t.createElement("label",{htmlFor:"priority"},"Page Priority (10 being the highest)")),t.createElement("div",{className:"modal-footer"},t.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%"}},t.createElement("button",{type:"button",className:"btn btn-danger","data-bs-dismiss":"modal",id:"close-seo-manager",onClick:this.props.resetData},"Close"),t.createElement("button",{type:"button",className:"btn btn-light",onClick:r},"Sign Out"),this.state.saving?t.createElement("div",{className:"spinner-border",role:"status"},t.createElement("span",{className:"visually-hidden"},"saving...")):t.createElement("button",{type:"button",className:"btn btn-success",onClick:this.saveData},"Save")))))}}export default m;
//# sourceMappingURL=Manager.js.map
