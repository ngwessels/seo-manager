import{__awaiter as e}from"../../node_modules/tslib/tslib.es6.js";import t from"react";import"./styles.css.js";import i from"../../node_modules/@mui/icons-material/Close.js";import{firebase as o}from"../../firebase.js";import{n as s}from"../../node_modules/@firebase/auth/dist/esm2017/index-6de4cbb9.js";import"../../node_modules/@firebase/app/dist/esm/index.esm2017.js";import"../../node_modules/@firebase/logger/dist/esm/index.esm2017.js";import{serverCall as l}from"../../utils/call.js";import r from"../../node_modules/@mui/material/styles/styled.js";import a from"../../node_modules/@mui/material/Dialog/Dialog.js";import n from"../../node_modules/@mui/material/DialogTitle/DialogTitle.js";import d from"../../node_modules/@mui/material/IconButton/IconButton.js";import m from"../../node_modules/@mui/material/DialogContent/DialogContent.js";import p from"../../node_modules/@mui/material/CircularProgress/CircularProgress.js";import c from"../../node_modules/@mui/material/DialogActions/DialogActions.js";import u from"../../node_modules/@mui/material/Button/Button.js";import h from"../../node_modules/@mui/lab/LoadingButton/LoadingButton.js";const g=r(a)((({theme:e})=>({"& .MuiDialogContent-root":{padding:e.spacing(2)},"& .MuiDialogActions-root":{padding:e.spacing(1)},"& .MuiPaper-root":{margin:"0px",width:"90vw",maxWidth:"900px"}}))),f=s(o);class y extends t.Component{constructor(t){super(t),this.componentDidMount=()=>{this.getData()},this.getData=()=>e(this,void 0,void 0,(function*(){var e,t;const i=yield l("/files/getProjectFiles","get",{},void 0,{X_Authorization:yield null===(e=null==f?void 0:f.currentUser)||void 0===e?void 0:e.getIdToken(),AuthorizationId:null===(t=null==f?void 0:f.currentUser)||void 0===t?void 0:t.uid});console.log("FILES:",i.results.photos),i.results.photos.length>0?this.setState({photos:i.results.photos,loading:!1}):this.setState({loading:!1})})),this.imageClicked=e=>{const t={url:e.url,fileId:e.fileId};if(!0===this.props.multiple){let i=[];this.state.selectedArray&&(i=[...this.state.selectedArray]);const o=i.indexOf((t=>{if(t.fileId===e.fileId)return!0}));o>=0?(i.splice(o,1),this.setState({selectedArray:i})):(i.push(t),this.setState({selectedArray:i}))}else this.state.selected.fileId===e.fileId?this.setState({selected:{url:"",fileId:""}}):this.setState({selected:t})},this.save=()=>{!0===this.props.multiple?this.props.onChangeComplete(this.state.selectedArray):this.props.onChangeComplete(this.state.selected),this.props.onClose()},this.state={photos:[],loading:!0,selected:!0===t.multiple&&t.selected?{url:"",fileId:""}:Object.assign({},t.selected),selectedArray:!0===t.multiple&&t.selected?[...t.selected]:[]}}render(){return t.createElement(t.Fragment,null,t.createElement(g,{onClose:this.props.onClose,"aria-labelledby":"customized-dialog-title",open:this.props.open,maxWidth:!1},t.createElement(n,{sx:{m:0,p:2}},"Photo Manager",t.createElement(d,{"aria-label":"close",onClick:this.props.onClose,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]}},t.createElement(i,null))),t.createElement(m,null,this.state.loading&&t.createElement("div",{style:{width:"100%",height:400,display:"flex",justifyContent:"center",alignItems:"center"}},t.createElement(p,null)),!1===this.state.loading&&t.createElement("div",{style:{display:"flex",flexDirection:"column",minHeight:400,padding:15}},t.createElement("div",{style:{},className:"top"}),t.createElement("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"flex-start",maxHeight:500,overflowY:"scroll",paddingTop:20,paddingBottom:20,borderTop:"#e3e3e3 solid 1px",borderBottom:"#e3e3e3 solid 1px"},className:"fileViewer"},this.state.photos.map(((e,i)=>{let o=!1;if(!0===this.props.multiple){this.state.selectedArray.indexOf((t=>{if(t.fileId===e.fileId)return!0}))>=0&&(o=!0)}else this.state.selected.fileId===e.fileId&&(o=!0);return t.createElement("div",{style:{width:150,height:150,overflow:"hidden",margin:10,cursor:"pointer",borderRadius:2,border:o?"#8a8a8a solid 2px":"#e3e3e3 dashed 1px"},key:`Photo-${i}`,onClick:()=>this.imageClicked(e)},t.createElement("img",{src:e.url,width:e.dimensions.width,height:e.dimensions.height,style:{width:"100%",height:"100%",objectFit:"contain"}}))}))))),t.createElement(c,null,t.createElement("div",{className:"modal-footer",style:{width:"100%"}},t.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%"}},t.createElement(u,{variant:"text",id:"close-seo-manager",onClick:this.props.onClose,type:"button"},"Close"),t.createElement(h,{variant:"text",onClick:this.save,type:"button",loading:!1},"Save"))))))}}export default y;
//# sourceMappingURL=Photos.js.map
